<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<meta name="_csrf" th:content="${_csrf.token}"/>
	<meta name="_csrf_header" th:content="${_csrf.headerName}"/>
	<title>Aurora</title>

	<!-- Google Font: Source Sans Pro -->
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,400i,700&display=fallback">
	<!-- Font Awesome -->
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.7.2/css/all.min.css"/>
	<!-- Theme style -->
	<link rel="stylesheet" href="../../dist/css/adminlte.min.css">
	<!-- Toast Grid -->
	<link rel="stylesheet" href="https://uicdn.toast.com/grid/latest/tui-grid.css" />

	<!-- jQuery -->
	<script src="../../plugins/jquery/jquery.min.js"></script>
	<!-- Bootstrap 4 -->
	<script src="../../plugins/bootstrap/js/bootstrap.bundle.min.js"></script>
	<!-- AdminLTE App -->
	<script src="../../dist/js/adminlte.min.js"></script>
	<!-- Toast Grid -->
	<script src="https://uicdn.toast.com/tui-grid/latest/tui-grid.min.js"></script>
	
	<style>
		#keyboard {
			display: grid;
		    grid-template-columns: repeat(3, 1fr);
		    gap: 3px;
		    width: 100%;
		    max-width: 100%;
			margin-bottom: 20px;
		}
		
		#keyboard .btn {
			flex: 1;
			aspect-ratio: 1 / 1;
		    display: flex; 
		    align-items: center; 
		    justify-content: center;
			font-size: 1.5rem;
		}
		
		.tui-grid-cell-has-input  {
		    background-color: white !important;
		}
	</style>
	
</head>
<body class="layout-top-nav">
	<div class="wrapper">
		<div class="content-wrapper">
			<!-- Main content -->
			<section class="content pt-2">
				<div class="content-fluid">
					<div class="card">
						<div class="card-header">
							<div class="row mb-2">
								<div class="col-6">
									<button type="button" class="btn btn-warning btn-lg" data-toggle="defectRegist" data-target="#modal-xl"><i class="fa-solid fa-circle-minus mr-1"></i> 불량등록</button>										
								</div>
							</div>
						</div>
						<div class="card-body">
							<div class="row">
								<div class="col-4">
									<div id="workcenter">
										<!-- Toast Grid -->
									</div>
								</div>
								<div class="col-8">
									<div id="inboundDetail">
										<!-- Toast Grid -->
									</div>
								</div>
							</div>
						</div>
<!--						<div th:insert="~{POP/inbound/inboundInspection :: inboundInspection}"></div>-->
					</div>
				</div>
			</section>
			<!-- /.Main content -->
		</div>
	</div>
	<!-- ./wrapper -->
	
	<!-- Page specific script -->
	<script th:inline="javascript">
		let workcenterGrid = null;
		/*
		let inboundDetailGrid = null;
		let rejectionGrid = null;
		let rejectionInputGrid = null;
		let po_id = '';
		let po_detail_data = [];
		*/
		
		const workcenter_url = '/rest/production/workcenter';
		const workcenter_dataSource = {
			api: {
				readData: {url: workcenter_url, method: 'GET'},
			},
			contentType: 'application/json',
		};
		
		$(function () {
			workcenterInit();
		});
		
		function workcenterInit() {
			workcenterGrid = new tui.Grid({
				el: document.getElementById('workcenter'),
				data: workcenter_dataSource,
				scrollX: true,
				scrollY: false,
				bodyHeight: 770,
				rowHeight: 60,
				columns: [
					{header: '워크센터 코드', name: 'WORKCENTER_ID', align: 'center'},
					{header: '워크센터명', name: 'WORKCENTER_NAME', align: 'left'},
					{header: '작동상태', name: 'WORKING_CNT', align: 'center'},
				],
				
			});
			
			workcenterGrid.on('click', (ev) => {
				if (ev.targetType != "cell") {
					return;
				}
				
				workcenterGrid.setSelectionRange({
					start: [ev.rowKey, 0],
					end: [ev.rowKey, workcenterGrid.getColumns().length]
				});
				
				const workcenterId = workcenterGrid.getValue(ev.rowKey, "WORKCENTER_ID");
				//inboundDetail(workcenterId);
			});
		}
		
		/*
		function inboundDetail(po_id) {
			if(inboundDetailGrid) {
				inboundDetailGrid.destroy();
				inboundDetailGrid = null;
			}
			
			// Button 
			class ButtonRenderer {
				constructor(props) {
					const el = document.createElement('button');
					el.textContent = '불량등록';
					el.classList.add('btn', 'btn-outline-primary');
					
					el.setAttribute("data-bs-toggle", "modal");
					el.setAttribute("data-bs-target", "#inboundInspection");

					el.addEventListener('click', (ev) => {
						const rowKey = props.rowKey;
						po_detail_data = props.grid.getRow(rowKey);
						
						
						
						const modal = new bootstrap.Modal(document.getElementById('inboundInspection'));
						modal.show();
					});
					
					this.el = el;
				}
				getElement() {
					return this.el;
				}
			}
			
			const url = `/inspection/inboundDetail?po_id=${encodeURIComponent(po_id)}`;
			const inboundDetailDataSource = {
				api: {
					readData: {url: url, method: 'GET'}
				},
				contentType: 'application/json',
			};

			inboundDetailGrid = new tui.Grid({
				el: document.getElementById('inboundDetail'),
				data: inboundDetailDataSource,
				scrollX: false,
				scrollY: false,
				columns: [
					{ header: '상세ID', name: 'PODETAIL_ID', align: 'center', },
					{ header: '자재코드', name: 'MATERIAL_ID', align: 'center', },
					{ header: '자재명', name: 'MATERIAL_NAME', align: 'center' },
					{ header: '주문수량', name: 'PO_COUNT', align: 'center' },
					{ header: '입고수량', name: '', align: 'center' },
					{ header: '불량유형', name: '', align: 'center'},
					{ header: '', renderer: {type: ButtonRenderer}, align: 'center', width: 150 },
				],
				editingEvent: 'none',
				rowHeight: 60,
			});

			// 셀 선택 시 전체 행 선택 및 rejectionInputGrid 업데이트
			inboundDetailGrid.on('focusChange', (ev) => {
				inboundDetailGrid.setSelectionRange({
					start: [ev.rowKey, 0],
					end: [ev.rowKey, inboundDetailGrid.getColumns().length - 1]
				});
			});
		}
		*/
	</script>
<!--	<script th:src="@{/js/inboundInspection.js}"></script>-->
</body>
</html>